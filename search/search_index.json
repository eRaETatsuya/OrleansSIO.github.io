{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Bienvenue chez le sportludique d'Orl\u00e9ans","text":""},{"location":"#presentation-du-projet","title":"Pr\u00e9sentation du projet","text":"<p>Le projet consiste en la cr\u00e9ation d'une infrastructure r\u00e9seau pour le sportludique d'Orl\u00e9ans.</p> <p>Le sportludique d'Orl\u00e9ans a besoin d'une infrastructure r\u00e9seau pour pouvoir g\u00e9rer ses activit\u00e9s et ses membres.</p>"},{"location":"#presentation-de-lequipe","title":"Pr\u00e9sentation de l'\u00e9quipe","text":"<p>Nous sommes une \u00e9quipe de 3 \u00e9tudiants en 2\u00e8me ann\u00e9e de BTS SIO (Services Informatiques aux Organisations) au lyc\u00e9e Fulbert de Chartres.</p> <ul> <li>Mateja</li> <li>Lohann</li> <li>Yan</li> </ul>"},{"location":"Guac/","title":"Installation et configuration d'Apache Guacamole sur Debian 11","text":""},{"location":"Guac/#etape-1-installation-des-dependances","title":"\u00c9tape 1 : Installation des d\u00e9pendances","text":"<p>Sur notre machine Debian, nous commen\u00e7ons par installer les d\u00e9pendances n\u00e9cessaires avec les commandes suivantes :</p> <pre><code>sudo apt-get update\nsudo apt-get install build-essential libcairo2-dev libjpeg62-turbo-dev libpng-dev libtool-bin uuid-dev libossp-uuid-dev libavcodec-dev libavformat-dev libavutil-dev libswscale-dev freerdp2-dev libpango1.0-dev libssh2-1-dev libtelnet-dev libvncserver-dev libwebsockets-dev libpulse-dev libssl-dev libvorbis-dev libwebp-dev\n</code></pre>"},{"location":"Guac/#etape-2-telechargement-et-installation-de-guacamole-server","title":"\u00c9tape 2 : T\u00e9l\u00e9chargement et installation de guacamole-server","text":"<p>Nous nous positionnons dans le r\u00e9pertoire /tmp et t\u00e9l\u00e9chargeons l'archive tar.gz de Guacamole Server :</p> <pre><code>cd /tmp\nwget https://downloads.apache.org/guacamole/1.5.2/source/guacamole-server-1.5.2.tar.gz\n# ou \nwget https://dlcdn.apache.org/guacamole/1.5.2/source/guacamole-server-1.5.2.tar.gz\n</code></pre> <p>Une fois le t\u00e9l\u00e9chargement termin\u00e9, nous d\u00e9comprimons l'archive et nous nous positionnons dans le r\u00e9pertoire obtenu :</p> <pre><code>tar -xzf guacamole-server-1.5.2.tar.gz\ncd guacamole-server-1.5.2/\n</code></pre> <p>Nous configurons et compilons le code source de guacamole-server :</p> <pre><code>sudo ./configure --with-init-dir=/etc/init.d\nsudo make\nsudo make install\n</code></pre> <p>Nous mettons \u00e0 jour les liens entre guacamole-server et les librairies :</p> <pre><code>sudo ldconfig\n</code></pre>"},{"location":"Guac/#etape-3-configuration-et-demarrage-du-service-guacd","title":"\u00c9tape 3 : Configuration et d\u00e9marrage du service guacd","text":"<p>Nous d\u00e9marrons le service guacd et le configurons pour un d\u00e9marrage automatique :</p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl start guacd\nsudo systemctl enable guacd\n</code></pre> <p>Nous v\u00e9rifions le statut du service :</p> <pre><code>sudo systemctl status guacd\n</code></pre>"},{"location":"Guac/#etape-4-configuration-du-repertoire-de-guacamole","title":"\u00c9tape 4 : Configuration du r\u00e9pertoire de Guacamole","text":"<p>Nous cr\u00e9ons l'arborescence pour la configuration d'Apache Guacamole :</p> <pre><code>sudo mkdir -p /etc/guacamole/{extensions,lib}\n</code></pre>"},{"location":"Guac/#etape-5-installation-de-tomcat9-et-de-la-web-app-de-guacamole","title":"\u00c9tape 5 : Installation de Tomcat9 et de la Web App de Guacamole","text":"<p>Nous installons Tomcat9 :</p> <pre><code>sudo apt-get install tomcat9 tomcat9-admin tomcat9-common tomcat9-user\n</code></pre> <p>Nous t\u00e9l\u00e9chargeons la Web App d'Apache Guacamole et la d\u00e9pla\u00e7ons dans le r\u00e9pertoire de Web App de Tomcat9 :</p> <pre><code>cd /tmp\nwget https://downloads.apache.org/guacamole/1.5.2/binary/guacamole-1.5.2.war\nsudo mv guacamole-1.5.2.war /var/lib/tomcat9/webapps/guacamole.war\n</code></pre> <p>Nous red\u00e9marrons les services Tomcat9 et guacd :</p> <pre><code>sudo systemctl restart tomcat9 guacd\n</code></pre>"},{"location":"Guac/#etape-6-configuration-de-la-base-de-donnees-mariadb","title":"\u00c9tape 6 : Configuration de la base de donn\u00e9es MariaDB","text":"<p>Nous installons MariaDB Server :</p> <pre><code>sudo apt-get install mariadb-serv\n</code></pre> <p>Nous s\u00e9curisons l'installation de MariaDB :</p> <pre><code>sudo mysql_secure_installation\n</code></pre> <p>Nous nous connectons \u00e0 MariaDB pour cr\u00e9er une base de donn\u00e9es et un utilisateur d\u00e9di\u00e9 \u00e0 Guacamole :</p> <pre><code>mysql -u root -p\n\n\nCREATE DATABASE guacadb;\nCREATE USER 'admin'@'localhost' IDENTIFIED BY 'P@ssword!';\nGRANT SELECT,INSERT,UPDATE,DELETE ON guacadb.* TO 'guaca_nachos'@'localhost';\nFLUSH PRIVILEGES;\nEXIT;\n</code></pre>"},{"location":"Guac/#etape-7-configuration-de-lauthentification-mysql-pour-guacamole","title":"\u00c9tape 7 : Configuration de l'authentification MySQL pour Guacamole","text":"<p>Nous t\u00e9l\u00e9chargeons et installons l'extension MySQL pour Guacamole :</p> <pre><code>cd /tmp\nwget https://downloads.apache.org/guacamole/1.5.2/binary/guacamole-auth-jdbc-1.5.2.tar.gz\ntar -xzf guacamole-auth-jdbc-1.5.2.tar.gz\nsudo mv guacamole-auth-jdbc-1.5.2/mysql/guacamole-auth-jdbc-mysql-1.5.2.jar /etc/guacamole/extensions/\n</code></pre> <p>Nous t\u00e9l\u00e9chargeons et installons le connecteur MySQL :</p> <pre><code>cd /tmp\nwget https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-j-8.0.33.tar.gz\ntar -xzf mysql-connector-j-8.0.33.tar.gz\nsudo cp mysql-connector-j-8.0.33/mysql-connector-j-8.0.33.jar /etc/guacamole/lib/\n</code></pre> <p>Nous importons la structure de la base de donn\u00e9es de Guacamole dans la base de donn\u00e9es guacadb :</p> <pre><code>cd guacamole-auth-jdbc-1.5.2/mysql/schema/\ncat *.sql | mysql -u root -p guacadb\n</code></pre> <p>Nous cr\u00e9ons et \u00e9ditons le fichier guacamole.properties :</p> <pre><code>sudo nano /etc/guacamole/guacamole.properties\n</code></pre> <p>Nous ins\u00e9rons les lignes suivantes :</p> <pre><code># MySQL\nmysql-hostname: 127.0.0.1\nmysql-port: 3306\nmysql-database: guacadb\nmysql-username: admin\nmysql-password: P@ssword!\n</code></pre> <p>Nous \u00e9ditons le fichier guacd.conf :            </p> <pre><code>sudo nano /etc/guacamole/guacd.conf\n</code></pre> <p>Nous ins\u00e9rons le code suivant :</p> <pre><code>[server]\nbind_host = 0.0.0.0\nbind_port = 4822\n</code></pre> <p>Nous red\u00e9marrons les services li\u00e9s \u00e0 Guacamole :</p> <pre><code>sudo systemctl restart tomcat9 guacd mariadb\n</code></pre> <p>On peut maintenant se connecter \u00e0 notre interface web en entrant <code>172.28.97.30:8080/guacamole</code> ou <code>guac.orleans.sportludique.fr:8080/guacamole</code></p> <p></p>"},{"location":"Hmail/","title":"Configuration du Serveur HMail sur Windows 10","text":"<ol> <li>T\u00e9l\u00e9chargement et Installation de HMail</li> <li>On t\u00e9l\u00e9charge la derni\u00e8re version stable depuis le site officiel.</li> <li> <p>On suit les instructions d'installation.</p> </li> <li> <p>Configuration Initiale de HMail</p> </li> <li>On ex\u00e9cute l'assistant de configuration.</li> <li> <p>On d\u00e9finit le nom de domaine et on ajoute des domaines, des utilisateurs et des bo\u00eetes aux lettres.</p> </li> <li> <p>Param\u00e8tres de S\u00e9curit\u00e9</p> </li> <li> <p>On configure les certificats SSL et on active le chiffrement TLS/SSL.</p> </li> <li> <p>Param\u00e8tres SMTP/POP3/IMAP</p> </li> <li>On configure les ports et les autorisations pour SMTP et IMAP.</li> </ol>"},{"location":"Hmail/#modifications-dans-le-serveur-dns","title":"Modifications dans le Serveur DNS","text":"<ol> <li>Enregistrements MX (Mail Exchange)</li> <li>On ajoute un enregistrement MX pour le domaine. </li> </ol> <ol> <li> <p>Redirection de Ports sur le Switch et le Pare-feu</p> </li> <li> <p>On redirige les ports 25 (SMTP) et 143 (IMAP) vers l'adresse IP du serveur HMail.</p> </li> <li>On configure les r\u00e8gles de redirection de ports sur le pare-feu.</li> <li>Test<ul> <li>On v\u00e9rifie la connectivit\u00e9 en envoyant/recevant des e-mails depuis l'ext\u00e9rieur.</li> </ul> </li> </ol>"},{"location":"NAT/","title":"NAT","text":""},{"location":"NAT/#redirection-de-port-de-nos-routeurs","title":"Redirection de port de nos routeurs :","text":"Nom d'h\u00f4te Adresse IP locale Protocole Port de d\u00e9but Port de Fin Interface Physique SRV-DNS 192.168.45.252 TCP 53 (DNS) 53 g0/1 SRV-DNS 192.168.45.252 UDP 53 (DNS) 53 g0/1 SRV-VPN 192.168.45.249 UDP 51820 (WIREGUARD) 51820 g0/1 SRV-VPN 192.168.45.249 TCP 51820 (WIREGUARD) 51820 g0/1 VIP Reverse-Proxy 192.168.45.200 TCP 81 (HTTP) 81 g0/1 VIP Reverse-Proxy 192.168.45.200 TCP 80 (HTTP) 80 g0/1 VIP Reverse-Proxy 192.168.45.200 TCP 443 (HTTPS) 443 g0/1 SRV-Hmail 192.168.45.240 TCP 25 (SMTP) 25 g0/1 SRV-Hmail 192.168.45.240 TCP 143 (IMAP) 143 g0/1"},{"location":"Squid/","title":"Installation Squid/SquidGuard","text":""},{"location":"Squid/#1-constatation","title":"1. Constatation","text":""},{"location":"Squid/#11-besoin","title":"1.1 Besoin","text":"<p>Pour installer le proxy nous avons besoins de cr\u00e9er une machine virtuelle Debian sur Nutanix</p>"},{"location":"Squid/#12-objectifs","title":"1.2 Objectifs","text":"<p>\u00c0 partir d\u2019un navigateur se connecter \u00e0 http://dsi.ut-capitole.fr/hidden/test (le test ne marcherait pas bien en HTTPS et il faut que l'ip du proxy soit recens\u00e9 dans le navigateur Firefox) On constate alors l\u2019information \u201dUser-Agent\u201d qui indique le nom et la version du navigateur et le nom et la version de l\u2019OS. Cette information, utile, va nous donner l\u2019occasion de voir ce qui peut \u00eatre fait par un relai applicatif.</p>"},{"location":"Squid/#2-squid","title":"2. Squid","text":""},{"location":"Squid/#21-installation","title":"2.1 Installation","text":"<p>L\u2019installation du relai proxy squid est assez simple (nous supposons utiliser squid3, mais dans la toute derni\u00e8re Debian, c\u2019est squid 4, qui est d\u00e9nomm\u00e9 \u201dsquid\u201d tout court).</p> <pre><code>apt-get install squid\n</code></pre> <p>Apr\u00e8s l'installation, un <code>squid.conf</code> s'est cr\u00e9e, remplit de commentaire, il faut supprimer l'inutile :</p> <pre><code>cd /etc/squid3\n# On cree une copie sous le nom squid.conf.distrib\ncp squid.conf squid.conf.distrib\n# On enleve les commentaires, puis on ne prend que les lignes avec 2 caracteres\ncat squid.conf|grep -Pv '^#'|grep -P '..' &gt; squid.conf.new\ncp squid.conf.new squid.conf\n</code></pre> <p>On peut alors lancer le squid</p> <pre><code>service squid start\n</code></pre> <p>Dans le cas o\u00f9 l\u2019on utilise la machine virtuelle, il sera n\u00e9cessaire d\u2019autoriser le r\u00e9seau, o\u00f9 se trouve la machine cliente (la machine physique), \u00e0 utiliser le squid local. Dans le fichier squid.conf on va donc ajouter une d\u00e9finition d\u2019ACL, puis utiliser cette d\u00e9finition. Il sera important de bien choisir l\u2019ordre dans lequel on va placer les acl et leur utilisation.</p> <pre><code>acl localclient src 172.16.0.0/12 #Cette ACL est d\u00e9j\u00e0 cr\u00e9\u00e9e mais dans l'installation de squid l'ACL a pour nom localnet moi je l'ai renomm\u00e9e localclient (en laissant le src)\n...\nhttp_access allow localclient #Il faut cr\u00e9er cette ACL\n</code></pre>"},{"location":"Squid/#22-verification","title":"2.2 V\u00e9rification","text":"<p>Pour v\u00e9rifier que le fichier est conforme et sans erreur:</p> <pre><code>squid -k check\n</code></pre>"},{"location":"Squid/#23-utilisation","title":"2.3 Utilisation","text":"<p>Se diriger vers Firefox, puis dans les param\u00e8tres, chercher proxy, puis recenser l'ip et le port du proxy: Le notre c'est 172.28.98.253:3128 et cliquer sur <code>Utiliser \u00e9galement ce proxy pour HTTPS</code></p>"},{"location":"Squid/#3-installation-de-squidguard","title":"3 Installation de SquidGuard","text":"<p>Squid ne peut bloquer que des URLs une par une, ce qui est long, donc on va installer SquidGuard</p> <pre><code>apt-get install squidguard\n</code></pre> <p>Une fois ceci fait, on signale \u00e0 squid d\u2019utiliser squidGuard. Pour cela, on modifie /etc/squid3/squid.conf</p> <pre><code>url_rewrite_program /usr/bin/squidGuard\n</code></pre>"},{"location":"Squid/#32-configuration-du-logiciel","title":"3.2 Configuration du logiciel","text":"<p>La configuration doit se faire avant l\u2019installation des bases de donn\u00e9es. Le fichier de configuration est, en g\u00e9n\u00e9ral, /etc/squidGuard/squidGuard.conf</p>"},{"location":"Squid/#33-les-bases-de-filtrage","title":"3.3 Les bases de filtrage","text":"<p>On rapatrie une base de filtrage et on l\u2019installe</p> <pre><code>cd /var/lib/squidguard/db\nwget http://dsi.ut-capitole.fr/blacklists/download/blacklists.tar.gz\n# On decompacte, un repertoire blacklists est alors cree\ntar zxvf blacklists.tar.gz\n# On cree un lien symbolique pour garder la notion de dest\nln -s blacklists dest\n# Pour accelerer le traitement (mais en reduisant considerablement le nombre de domaines filtres)\ncd dest/adult\ncp domains domains.originel\necho \"playboy.com\" &gt;domains\necho \"sex.com\" &gt;&gt;domains\necho \"lesitequevousvoulezajouter.com\" &gt;&gt; domains\nchown proxy:proxy domains\n</code></pre> <p>La structure des fichiers textes contenant la liste est cr\u00e9\u00e9e. Squidguard peut fonctionner tel quel (il recompilera les bases en m\u00b4emoire au d\u00e9marrage), mais cela ralentira consid\u00e9rablement tout d\u00e9marrage ou red\u00e9marrage. Il faut donc cr\u00e9er (compiler) les bases de donn\u00b4ees avant le lancement. Il faudra prendre la pr\u00e9caution d\u2019arr\u00eater le squid avant, si on veut que la compilation soit rapide.</p> <pre><code>mv database db\nservice squid stop\n/usr/bin/squidGuard -P -d -b -C all\nchown -R proxy:proxy /var/lib/squidguard/db\nservice squid start\n</code></pre> <p>Cette commande va compiler les bases de donn\u00b4ees qui sont utilis\u00b4ees dans le squidGuard.conf. Comme la commande a \u00b4et\u00b4e faite par root, les fichiers domains.db et urls.db lui appartiennent, il faut changer le propri\u00b4etaire. On peut alors relancer le squid</p>"},{"location":"Stormshield/","title":"-Stormshield","text":""},{"location":"Stormshield/#configuration-dun-firewall-stormshield-sn210","title":"Configuration d'un firewall Stormshield (SN210)","text":"<p>Pour la configuration du firewall, nous l'avions d'abord r\u00e9initialis\u00e9 en restant appuyer pendant plusieurs secondes sur le bouton qui se trouve \u00e0 l'arri\u00e8re du firewall.</p> <ol> <li>Pour configurer le pare-feu depuis son interface graphique, il faut se c\u00e2bler avec un c\u00e2ble rj45 sur le port IN(LAN) du pare-feu</li> <li>Se rendre internet et taper dans l'URL l'interface du pare-feu qui est <code>https://10.0.0.254/admin</code></li> <li>Arriver sur la page de connexion les informations de connexion sont admin et admin et vous pouvez \u00e9galement mettre la langue fran\u00e7aise en d\u00e9roulant les options.</li> </ol>"},{"location":"Stormshield/#configuration-des-interfaces-reseau-du-firewall","title":"Configuration des interfaces r\u00e9seau du firewall","text":"<ol> <li>Sur l'interface du Stormshield, il faut se rentre dans <code>configuration</code> et dans <code>interfaces</code>. </li> <li>En haut \u00e0 droite de l'interface Stormshield, appuyer sur <code>\u00e9criture</code> pour avoir des droits de modification. S\u00e9lectionner l'interface <code>IN</code>, dans l'onglet configuration g\u00e9n\u00e9rale:</li> <li>Compl\u00e9tez les informations de la zone Plan d'adressage :</li> <li>Champ Adressage : s\u00e9lectionnez Dynamique / Statique.</li> <li>Champ Adresse IPv4 : s\u00e9lectionnez IP fixe (statique).</li> <li>Dans la grille : cliquez sur Ajouter et renseignez 192.168.45.254/24. (LAN)  </li> <li>Cliquez sur Appliquer pour valider. </li> </ol> <p>Faire la m\u00eame chose pour le OUT, et renseignez comme ip 172.28.105.1/24. (WAN)  </p> <p>La connexion sera perdu, il faudra utiliser la nouvelle adresse IP pour vous connecter au firewall</p>"},{"location":"Stormshield/#configuration-du-nat","title":"Configuration du NAT","text":"<ul> <li>Ouvrez le menu Configuration / Politique de s\u00e9curit\u00e9 / Filtrage et NAT. :</li> <li>Il ne faut pas cr\u00e9er de r\u00e8gle dans le menu Pass All, dans le menu d\u00e9roulant s\u00e9lectionner un Filter et renommer le <code>Sportludique_Orl\u00e9ans</code>. </li> <li>Ensuite, cr\u00e9er les r\u00e8gles de NAT. Cliquer sur la cat\u00e9gorie <code>NAT</code> et sur <code>Nouvelle r\u00e8gle</code> et sur <code>r\u00e8gle simple</code> .</li> <li>Configurer comme sur l'image :</li> </ul>"},{"location":"Stormshield/#configuration-filtrage","title":"Configuration filtrage","text":"<ul> <li>M\u00eame principe, se diriger vers la cat\u00e9gorie <code>filtrage</code> et cr\u00e9er une nouvelle r\u00e8gle.  </li> <li>Il est important que le niveau d'inspection soit en <code>Ne pas d\u00e9t\u00e9cter</code> car il se pourrait que la protection antivirus de Stormshield bloque les requ\u00eates.</li> <li>La premi\u00e8re r\u00e8gle autoriser tout le trafic sortant depuis n'importe quel port source vers n'importe quel port destination sauf le port de destination, qui doit \u00eatre le port DNS.</li> <li>La deuxi\u00e8me autorise tout le trafic sortant sans aucune restriction.</li> </ul>"},{"location":"Stormshield/#configuration-des-routes-statiques","title":"Configuration des routes statiques","text":"<ul> <li>Cr\u00e9ation de la passerelle par d\u00e9faut(routeur):</li> <li>Toujours en mode \u00e9criture, cliquer sur l'icone \u00e0 droite de la listbox.</li> <li>Vous serez alors dans le menu <code>Cr\u00e9er un objet</code>.</li> <li>Il faut cr\u00e9er une <code>machine</code>, nom de l'objet \u00e0 mettre <code>vip_transport</code> ip : 172.28.105.254 et cliquer sur cr\u00e9er(la vip est utilis\u00e9es pour la redondance de connexion car nous  utilisons le protocole hsrp(protocole de redondance)).</li> <li>Se diriger vers <code>routeur</code> le <code>nom de l'objet</code> est <code>hsrp_gateway</code> puis <code>dans passerelles utilis\u00e9es</code> , cliquer sur ajouter.  </li> <li>Dans la cat\u00e9gorie <code>passerelle</code> indiquer la machine cr\u00e9er plus t\u00f4t qui correspondont \u00e0 la VIP (vip_transport).</li> <li>Cr\u00e9ation des routes : cliquer sur ajouter et rajouter ces routes :  </li> </ul>"},{"location":"VPN_WireGuard/","title":"Cr\u00e9ation du serveur VPN","text":""},{"location":"VPN_WireGuard/#etape-1-creation-du-serveur-vpn-sur-nutanix","title":"\u00c9tape 1: Cr\u00e9ation du Serveur VPN sur Nutanix","text":""},{"location":"VPN_WireGuard/#11-prerequis","title":"1.1 Pr\u00e9requis","text":"<p>Avant de commencer, il faut cr\u00e9er la machine virtuelle sur Nutanix, avec un OS Debian.</p>"},{"location":"VPN_WireGuard/#12-installation-de-wireguard","title":"1.2 Installation de WireGuard","text":"<p>Pour installer Wireguard, on suit le tuto de it-connect Sur la machine, recopier ces lignes.</p> <pre><code>sudo apt-get update\nsudo apt-get install wireguard\n</code></pre> <p>cr\u00e9ation interface wireguard :</p> <pre><code>en premier il faut g\u00e9n\u00e9rer une cl\u00e9 priv\u00e9 et une cl\u00e9 publique:\nwg genkey | sudo tee /etc/wireguard/wg-private.key | wg pubkey | sudo tee /etc/wireguard/wg-public.key\n</code></pre> <p>cr\u00e9ation du fichier de conf de l'interface :</p> <pre><code>sudo nano /etc/wireguard/wg0.conf\n</code></pre> <p>contenu du fichier :</p> <pre><code>[Interface]\nAddress = 10.255.255.1/24\nSaveConfig = true\nListenPort = 51820\nPrivateKey = &lt;cl\u00e9 priv\u00e9e du serveur&gt;\n</code></pre> <p>Pour obtenir la cl\u00e9 priv\u00e9 il faut faire la commande suivante :</p> <pre><code>sudo cat /etc/wireguard/wg-private.key\n</code></pre> <p>D\u00e9marrage de l'interface : </p> <pre><code>sudo wg-quick up wg0\n</code></pre> <p>attention a chaque fois qu'on manipule le fichier de conf de l'interface il faut que cette derni\u00e8re soit \u00e9teinte avec la commande :</p> <pre><code>sudo wg-quick down wg0\n</code></pre>"},{"location":"VPN_WireGuard/#13-activation-de-lip-forwarding","title":"1.3 Activation de l'IP Forwarding","text":"<p>Dans le fichier de conf suivant : </p> <pre><code>sudo nano /etc/sysctl.conf\n</code></pre> <p>Ajoutez cette ligne : </p> <pre><code>net.ipv4.ip_forward=1\n</code></pre>"},{"location":"VPN_WireGuard/#14-activation-de-lip-forwarding","title":"1.4 Activation de l'IP Forwarding","text":"<p>Activer l'IP Masquerade. Cela revient \u00e0 faire de notre serveur vpn un Routeur qui va NAT les requ\u00eates du r\u00e9seau vpn (10.255.255.0/24) vers les diff\u00e9rents r\u00e9seaux locaux.</p> <p>Installer ufw :</p> <pre><code>sudo apt-get install ufw\n</code></pre> <p>Autoriser des ports :</p> <pre><code>ssh -&gt; sudo ufw allow 22/tcp\nwireguard -&gt; sudo ufw allow 51820/udp\n</code></pre> <p>Dans le fichier /etc/ufw/before.rules :</p> <pre><code>sudo nano /etc/ufw/before.rules\n\najoutez ces lignes :\n\n# NAT - IP masquerade\n*nat\n:POSTROUTING ACCEPT [0:0]\n-A POSTROUTING -o ens3 -j MASQUERADE\n\n# End each table with the 'COMMIT' line or these rules won't be processed\nCOMMIT\n\n\n# autoriser le forwarding pour le r\u00e9seau distant de confiance (+ le r\u00e9seau du VPN)\n-A ufw-before-forward -s 192.168.45.0/24 -j ACCEPT\n-A ufw-before-forward -d 192.168.45.0/24 -j ACCEPT\n-A ufw-before-forward -s 10.255.255.0/24 -j ACCEPT\n-A ufw-before-forward -d 10.255.255.0/24 -j ACCEPT\n</code></pre> <p>Apr\u00e8s avoir modifier ce fichier :</p> <pre><code>sudo ufw enable\n\nsudo systemctl restart ufw\n</code></pre>"},{"location":"VPN_WireGuard/#etape-2-installation-wireguard-cote-client","title":"\u00c9tape 2: Installation Wireguard c\u00f4t\u00e9 client :","text":""},{"location":"VPN_WireGuard/#21-creation-dune-vm-client-sur-virtualbox","title":"2.1 Cr\u00e9ation d'une vm client sur virtualbox","text":""},{"location":"VPN_WireGuard/#22-installation-du-logiciel-wireguard-sur-cette-vm","title":"2.2 Installation du logiciel wireguard sur cette vm","text":""},{"location":"VPN_WireGuard/#23-creation-du-tunnel","title":"2.3 Cr\u00e9ation du tunnel","text":"<pre><code>- cliquer sur le bouton ajouter un tunnel vide\n\n- dans la fen\u00eatre de configuration qui s'ouvre rentrer dans le bloc interface l'information : Address = 10.255.255.2/24\n\n- ajouter un bloc [Peer]\n\n- dans ce bloc ajouter la cl\u00e9 public du serveur vpn qu'on peut obtenir avec la commande \"sudo cat /etc/wireguard/wg-public.key\". PublicKey = &lt;cl\u00e9 publique du serveur&gt;\n\n- Ajouter l'information AllowedIPs = 10.255.255.0/24, 192.168.45.0/24, 172.28.0.0/16\n\n- Ajouter l'ip publique suivi du port : EndPoint = ip_publique:51820\n(au pr\u00e9alable il faut avoir rediriger le port 51820 vers le serveur vpn sur le routeur)\n</code></pre>"},{"location":"VPN_WireGuard/#24-declaration-du-client-du-cote-du-serveur","title":"2.4 D\u00e9claration du client du cot\u00e9 du serveur","text":"<p>Il faut en premier \u00e9teindre l'interface wireguard</p> <pre><code>sudo wg-quick down wg0\n</code></pre> <p>Ensuite dans le fichier de conf de cette interface on va d\u00e9clarer le client</p> <pre><code>sudo nano /etc/wireguard/wg0.conf\n\najouter le bloc [Peer] avec la cl\u00e9 publique du client wireguard PublicKey = &lt;cl\u00e9 publique client&gt;\nensuite l'adresse ip du client du r\u00e9seau vpn AllowedIPs = 10.255.255.2/32\n</code></pre> <p>On peut maintenant rallumer l'interface apr\u00e8s avoir enregistr\u00e9 la configuration</p> <pre><code>sudo wg-quick up wg0\n</code></pre>"},{"location":"VPN_WireGuard/#etape-3-connexion-au-vpn-depuis-le-client","title":"\u00c9tape 3: Connexion au VPN depuis le client :","text":""},{"location":"VPN_WireGuard/#31-se-connecter-au-vpn-du-prof-sur-son-pc","title":"3.1 Se connecter au vpn du prof sur son pc :","text":"<p>Se connecter avec OpenVPN au VPN du professeur</p>"},{"location":"VPN_WireGuard/#32-se-connecter-au-vpn-wireguard-sur-une-vm","title":"3.2 Se connecter au vpn Wireguard sur une vm:","text":"<p>Il faut cr\u00e9er une vm windows 10 qui est connect\u00e9 en r\u00e9seau NAT dans la configuration de la VM.</p> <p>Ensuite il faut importer la conf vpn dans le client wireguard et cliquer sur \"Activer\".</p>"},{"location":"http_serv/","title":"\u00c9tapes d'Installation","text":""},{"location":"http_serv/#preparation-du-systeme","title":"Pr\u00e9paration du Syst\u00e8me :","text":"<p>Avant de commencer, j'ai v\u00e9rifi\u00e9 que mon syst\u00e8me Linux \u00e9tait \u00e0 jour en utilisant la commande suivante :</p> <p></p> <p><code>sudo apt update</code> <code>sudo apt upgrade</code></p> <p></p>"},{"location":"http_serv/#installation-dapache","title":"Installation d'Apache :","text":"<p>Pour installer Apache, j'ai ex\u00e9cut\u00e9 la commande suivante :</p> <p><code>sudo apt install apache2</code></p>"},{"location":"http_serv/#verification-dapache","title":"V\u00e9rification d'Apache :","text":"<p>Apr\u00e8s l'installation, j'ai v\u00e9rifi\u00e9 qu'Apache fonctionnait correctement en acc\u00e9dant \u00e0 l'adresse IP du serveur depuis un navigateur web. J'ai vu la page par d\u00e9faut d'Apache, ce qui signifie que l'installation \u00e9tait r\u00e9ussie.</p>"},{"location":"http_serv/#mise-en-place-du-https","title":"Mise en place du HTTPS","text":""},{"location":"http_serv/#creation-de-la-nouvelle-ca","title":"Cr\u00e9ation de la nouvelle CA :","text":"<p>On a g\u00e9n\u00e9r\u00e9 une cl\u00e9 priv\u00e9e pour la nouvelle CA :  <code>openssl genrsa -out nouvelle_ca.key 4096</code>  Ensuite, on a cr\u00e9\u00e9 un certificat pour cette CA :  <code>openssl req -x509 -new -nodes -key nouvelle_ca.key -sha256 -days 365 -out nouvelle_ca.crt</code>  On a rempli les informations demand\u00e9es pour le certificat.</p> <p>G\u00e9n\u00e9ration de la cl\u00e9 priv\u00e9e pour le certificat du serveur :  <code>openssl genrsa -out server.key 2048</code>  Cr\u00e9ation d'une demande de signature de certificat (CSR) pour le serveur :</p> <p>On a g\u00e9n\u00e9r\u00e9 un CSR pour le serveur avec la cl\u00e9 priv\u00e9e cr\u00e9\u00e9e pr\u00e9c\u00e9demment :  <code>openssl req -new -key server.key -out server.csr</code>  On a fourni les informations n\u00e9cessaires pour le certificat.</p> <p>Signature du certificat du serveur avec la nouvelle CA :</p> <p>On a sign\u00e9 le CSR du serveur avec la nouvelle CA pour \u00e9mettre un certificat :  <code>openssl x509 -req -in server.csr -CA nouvelle_ca.crt -CAkey nouvelle_ca.key -CAcreateserial -out server.crt -days 365 -sha256</code> </p> <p>On modifie le fichier .conf de notre site d'Orleans qui se trouve dans cette racine /etc/apache2/sites-available et on redirige la page http en page https</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName Orleans.sportludique.fr\n    ServerAlias www.orleans.sportludique.fr\n\n    Redirect permanent / https://192.168.45.253\n&lt;/VirtualHost&gt;\n\n&lt;VirtualHost *:443&gt;\n    ServerName Orleans.sportludique.fr\n    ServerAlias www.orleans.sportludique.fr\n    DocumentRoot /var/www/html\n\n    SSLEngine on\n    SSLCertificateFile /certificats/server.crt\n    SSLCertificateKeyFile /mykey/server.key\n\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"http_serv/#rapport-de-resolution-de-probleme","title":"Rapport de R\u00e9solution de Probl\u00e8me :","text":""},{"location":"http_serv/#probleme-signale","title":"Probl\u00e8me Signal\u00e9","text":"<p>Le site web ne fonctionnait pas correctement, la page restait redirig\u00e9e sur un seul serveur web.</p>"},{"location":"http_serv/#etapes-de-resolution","title":"\u00c9tapes de R\u00e9solution","text":"<ol> <li>D\u00e9sactivation du Port 443 sur les deux serveurs :    ```bash    sudo a2dismod ssl    sudo systemctl restart apache2</li> </ol> <p>### Identification du Probl\u00e8me Apr\u00e8s avoir d\u00e9sactiv\u00e9 le port 443, il a \u00e9t\u00e9 constat\u00e9 que la redirection persistait. Cela a conduit \u00e0 la recherche d'autres causes potentielles.</p>"},{"location":"http_serv/#decouverte-du-fichier-htaccess","title":"D\u00e9couverte du Fichier .htaccess","text":"<p>En examinant les serveurs web, un fichier <code>.htaccess</code> a \u00e9t\u00e9 d\u00e9couvert \u00e0 la racine du site. Ce fichier contenait des directives de redirection forc\u00e9e vers le port 443.</p>"},{"location":"http_serv/#suppression-du-fichier-htaccess","title":"Suppression du Fichier .htaccess","text":"<p>Le fichier <code>.htaccess</code> a \u00e9t\u00e9 supprim\u00e9 pour \u00e9liminer les directives de redirection ind\u00e9sirables.</p> <pre><code>  rm .htaccess\n</code></pre>"},{"location":"http_serv/#suppression-du-favicon-et-son-impact","title":"Suppression du Favicon et Son Impact","text":"<p>Suite \u00e0 l'identification du favicon de la page par d\u00e9faut d'Apache comme un facteur contribuant \u00e0 la redirection ind\u00e9sirable, le favicon a \u00e9t\u00e9 supprim\u00e9. Le favicon personnalis\u00e9 emp\u00eachait le reverse proxy de r\u00e9aliser la redirection vers le deuxi\u00e8me serveur web.</p>"},{"location":"http_serv/#reactivation-du-port-443","title":"R\u00e9activation du Port 443","text":"<p>Apr\u00e8s la suppression du fichier <code>.htaccess</code> et du favicon, le port 443 a \u00e9t\u00e9 r\u00e9activ\u00e9 avec la commande <code>a2enmod</code>.</p> <pre><code> sudo a2enmod ssl\n sudo systemctl restart apache2\n</code></pre>"},{"location":"pfsense/","title":"Configuration du Firewall OPNsense","text":"<ul> <li>Pour la configuration du pare-feu, le d\u00e9but est tr\u00e8s simple : il suffit de lui attribuer 2 interfaces r\u00e9seau, <code>LAN</code> et <code>WAN</code>;</li> </ul> <p>LAN est l'entr\u00e9e du pfSense. Si l'on se r\u00e9f\u00e8re au sch\u00e9ma, on doit lui attribuer l'adresse IP  <code>172.28.98.254</code>, et pour le WAN, l'adresse IP  <code>192.168.45.1</code></p> <p> </p>"},{"location":"pfsense/#configuration-de-la-gateway-pour-le-wan-et-le-lan","title":"Configuration de la gateway pour le WAN et le LAN","text":"<ul> <li> <p>WAN on lui attrtibue la passerelle <code>192.168.45.254</code>, qui est le LAN du Stormshield, qui nous sert de porte de sortie </p> </li> <li> <p>LAN on lui attribue la passerelle <code>172.28.98.254</code> </p> </li> <li> <p>Sur le firewall pfsense, on active la r\u00e8gle <code>Pass</code>, qui va permettre de tout laisser passer sur le r\u00e9seau sans filtres. </p> </li> </ul>"},{"location":"plan_adressage/","title":"Plan d'adressage du r\u00e9seau","text":"<p>L'ensemble du r\u00e9seau se repose sur l'adresse r\u00e9seau <code>172.28.96.0/19</code>.</p>"},{"location":"plan_adressage/#reseau-dorleans","title":"R\u00e9seau d'Orl\u00e9ans","text":"@Reseau @Diffusion VLAN Masque d\u00e9cimal  / CIDR 172.28.96.0 172.28.127.255 240-249 255.255.224.0 /19"},{"location":"plan_adressage/#plan-adressage-sous-reseau-vlan","title":"Plan adressage sous r\u00e9seau (VLAN)","text":"VLAN @R\u00e9seau Plage d'adresse @Diffusion Management / 240 172.28.96.0 /24 172.28.96.1 - 172.28.96.254 172.28.96.255 Serveur / 241 172.28.97.0 /24 97.1 - 172.28.97.254 172.28.97.255 core2dmz / 242 172.28.98.0 /24 98.1 - 98.254 172.28.98.255 DMZ Priv\u00e9e / 243 192.168.145.254 145.1-145.254 192.168.145.255 DMZ / 244 192.168.45.254 /24 45.1 - 45.254 192.168.45.255 Utilisateurs / 245 172.28.101.0 /24 101.1 - 101.254 172.28.100.255 VLAN 246 172.28.102.0 /24 102.1 - 102.254 172.28.100.255 VLAN 247 172.28.103.0 /24 103.1 - 103.254 172.28.100.255 VLAN 248 172.28.104.0 /24 104.1 - 104.254 172.28.100.255 VLAN 249 172.28.105.0 /24 105.1 - 105.254 172.28.100.255"},{"location":"plan_adressage/#site-dorleans","title":"Site d'Orl\u00e9ans","text":"Nom Adresse VLAN 240 Management 172.28.96.254 /24 VLAN 241 Serveur 172.28.97.254 /24 VLAN 242 CORE2DMZ 172.28.98.1 /24 VLAN 243 DMZ Priv\u00e9e Pas d'ip attribu\u00e9e VLAN 245 Utilisateur 172.28.101.254 /24 VLAN 249 transport Pas d'ip attribu\u00e9e VLAN 244 DMZ Pas d'ip attribu\u00e9e Firewall virtuel 172.28.98.254 /24 Firewall IN(LAN) 192.168.45.254 /24 Firewall OUT(WAN) 172.28.105.1 /24"},{"location":"plan_adressage/#ip-fixes","title":"Ip fixes","text":"Nom Adresse R1-ORL (int g0/0.249) 172.28.105.253 /24 ; (int g0/0.240) 172.28.96.100 /24 R2-ORL (int g0/0.249) 172.28.105.252 /24 ; (int g0/0.240) 172.28.96.200 /24 OPNsense OUT(WAN) 192.168.45.1 /24  ;  IN(LAN) 172.28.98.254 /24 ; interface management 172.28.96.250 /24; DMZ PRIVEE 192.168.45.254/24 Contr\u00f4leur de Domaine 172.28.96.10 /24  ; 172.28.97.10 /24 Serveur web (Linux - Debian12) 192.168.45.253 /24 ; interface management 172.28.96.251 /24 SQUID 172.28.98.253 /24  ; interface management 172.28.96.253 /24; Serveur DNS forwarder (bind9) 172.28.97.20 /24 Serveur Split DNS (bind9) 192.168.45.252 /24 Serveur Docker 192.168.45.251 /24 Serveur MariaDB 192.168.145.10 /24 Serveur Reverse Proxy 192.168.45.250 /24 PASSIF Reverse PROXY 192.168.45.248 /24 Serveur VPN 192.168.45.249 /24 INT WIREGUARD (Sur serveur VPN) 10.255.255.1/24 VIP REVERSE PROXY 192.168.45.200/24 PASSIF Serveur WEB 192.168.45.247/24 HMail Serveur 192.168.45.240/24 HTTP SLAM Serveur 192.168.45.246/24 Serveur Guacamole 172.28.97.30/24 ; 172.28.96.252 Point d'acces 172.28.96.248"},{"location":"pointacces/","title":"Configuration du point d'acces WIFI Orleans et Orleans INVITE","text":""},{"location":"pointacces/#creation-des-ssids","title":"Creation des SSIDs","text":"<p>Tout d'abord, il nous faut rentrer sur l'interface WEB du point d'acces pour cela on entre son adresse ip sur le navigateur : </p> <p>Ensuite on se login avec les identifiants par defaut (admin admin) on arrivera sur l'interface de gestion :</p>"},{"location":"pointacces/#configuration-de-linterface-vlan-245","title":"Configuration de l'interface VLAN 245 :","text":"<ul> <li> <p>Objectif : Attribution d'adresses IP pour le VLAN 245.</p> </li> <li> <p>\u00c9tapes r\u00e9alis\u00e9es :</p> </li> <li>Attribution d'une plage d'adresses IP sur le serveur DHCP pour le VLAN 245.</li> <li>Configuration du relais DHCP sur le commutateur pour rediriger les requ\u00eates DHCP vers le serveur DHCP appropri\u00e9.</li> <li>V\u00e9rification de la connectivit\u00e9 r\u00e9seau des clients du VLAN 245.</li> </ul>"},{"location":"pointacces/#configuration-de-linterface-vlan-246","title":"Configuration de l'interface VLAN 246 :","text":"<ul> <li> <p>Objectif : Attribution d'adresses IP pour le VLAN 246 et autorisation d'acc\u00e8s \u00e0 Internet.</p> </li> <li> <p>\u00c9tapes r\u00e9alis\u00e9es :</p> </li> <li>Attribution d'une plage d'adresses IP sur le serveur DHCP pour le VLAN 246.</li> <li>Configuration du relais DHCP sur le commutateur pour rediriger les requ\u00eates DHCP vers le serveur DHCP appropri\u00e9.</li> <li>Configuration d'une ACL pour le VLAN 246 permettant l'acc\u00e8s \u00e0 la passerelle par d\u00e9faut et \u00e0 Internet.</li> <li>V\u00e9rification de la connectivit\u00e9 r\u00e9seau des clients du VLAN 246.</li> </ul>"},{"location":"ports/","title":"-Attribution des Ports","text":""},{"location":"ports/#attribution-des-vlans-aux-ports-du-switch","title":"Attribution des vlans aux ports du switch","text":""},{"location":"resolveur_dns/","title":"-Resolveur","text":""},{"location":"resolveur_dns/#creation-dune-vm-dans-le-vlan-serveur-241","title":"Cr\u00e9ation d'une vm dans le vlan serveur (241)","text":""},{"location":"resolveur_dns/#installation-de-bind9","title":"installation de bind9","text":"<p><code>sudo apt-get install bind9</code></p> <p>Dans le fichier /etc/bind/named.conf.options</p>"},{"location":"reverse_proxy/","title":"Compte Rendu - Configuration Nginx et Reverse Proxy","text":""},{"location":"reverse_proxy/#objectif","title":"Objectif","text":"<p>Configurer Nginx en tant que serveur web et reverse proxy sur un serveur Debian 12. Rediriger le trafic HTTP vers HTTPS, mettre en place un reverse proxy pour plusieurs sites, et configurer SSL.</p>"},{"location":"reverse_proxy/#etapes-accomplies","title":"\u00c9tapes Accomplies","text":""},{"location":"reverse_proxy/#1-installation-de-nginx","title":"1. Installation de Nginx","text":"<p> <code>sudo apt update</code> <code>sudo apt install nginx</code></p> <ol> <li> <p>Configuration de Base R\u00e9glage du pare-feu pour autoriser le trafic HTTP/HTTPS. D\u00e9marrage du service Nginx.</p> </li> <li> </li> </ol>"},{"location":"reverse_proxy/#reverse-proxy-avec-nginx","title":"Reverse Proxy avec Nginx","text":"<p>Configuration d'un fichier de site .conf dans le dossier /etc/nginx/nginx.conf pour le reverse proxy. Utilisation de proxy_pass pour rediriger le trafic vers une application interne.</p>"},{"location":"reverse_proxy/#redirection-http-vers-https","title":"Redirection HTTP vers HTTPS","text":"<p>Configuration des blocs de serveurs pour rediriger le trafic HTTP vers HTTPS. Utilisation de return 301 pour effectuer la redirection.</p>"},{"location":"reverse_proxy/#configuration-ssltls","title":"Configuration SSL/TLS","text":"<p>Cr\u00e9ation d'un fichier PEM combinant certificat et cl\u00e9 priv\u00e9e. Configuration du serveur Nginx pour utiliser le fichier PEM.</p>"},{"location":"reverse_proxy/#gestion-de-plusieurs-sites","title":"Gestion de Plusieurs Sites","text":"<p>Configuration de plusieurs blocs de serveurs pour diff\u00e9rents domaines. Utilisation de proxy_pass pour rediriger le trafic vers des serveurs internes distincts.</p> <pre><code>    server {\n      listen 80;\n      server_name orleans.sportludique.fr;\n      return 301 https://orleans.sportludique.fr$request_uri;\n    }\n\n    server {\n         listen 80;\n         server_name blog.orleans.sportludique.fr;\n         return 301 https://blog.orleans.sportludique.fr$request_uri;\n    }\n\n    server {\n\n            listen 443 ssl;\n\n            server_name orleans.sportludique.fr;\n\n\n            ssl_certificate /orleans-sportludique/certificat_et_cle.pem;\n\n            ssl_certificate_key /orleans-sportludique/certificat_et_cle.pem;\n\n\n\n            ssl_protocols TLSv1.2 TLSv1.3;\n\n            ssl_prefer_server_ciphers off;\n\n\n\n\n\n            location / {\n\n                        proxy_pass https://192.168.45.253;\n\n                        proxy_set_header Host $host;\n\n                        proxy_set_header X-Real-IP $remote_addr;\n\n                        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n                        proxy_set_header X-Forwarded-Proto $scheme;\n\n            }\n\n     }\n\n\n\n     server {\n\n             listen 443 ssl;\n\n             server_name blog.orleans.sportludique.fr;\n\n\n            ssl_certificate /orleans-sportludique/certificat_et_cle.pem;\n            ssl_certificate_key /orleans-sportludique/certificat_et_cle.pem;\n            ssl_protocols TLSv1.2 TLSv1.3;\n            ssl_prefer_server_ciphers off;\n\n\n\n           # Autres directives de configuration SSL/TLS...\n\n\n\n             location / {\n\n                         proxy_pass https://192.168.45.253;\n\n                         proxy_set_header Host $host;\n\n                         proxy_set_header X-Real-IP $remote_addr;\n\n                         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n                         proxy_set_header X-Forwarded-Proto $scheme;\n\n             }\n\n     }\n     server {\n\n             listen 80;\n\n             server_name node.orleans.sportludique.fr;\n\n\n           # Autres directives de configuration SSL/TLS...\n\n\n\n             location / {\n\n                         proxy_pass http://192.168.45.251:80;\n\n                         proxy_set_header Host $host;\n\n                         proxy_set_header X-Real-IP $remote_addr;\n\n                         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\n                         proxy_set_header X-Forwarded-Proto $scheme;\n\n             }\n\n     }\n</code></pre> <ol> <li>V\u00e9rification et Tests Utilisation de commandes comme sudo nginx -t pour v\u00e9rifier la configuration. Tests d'acc\u00e8s aux sites depuis un navigateur pour s'assurer que les redirections et le reverse proxy fonctionnent correctement.</li> <li>Probl\u00e8mes Rencontr\u00e9s Gestion des erreurs li\u00e9es \u00e0 la suppression d'une entr\u00e9e statique NAT sur un routeur Cisco. V\u00e9rification des traductions NAT, connexions actives, et suppression des sessions pour r\u00e9soudre des probl\u00e8mes de suppression d'entr\u00e9e NAT. Conclusion La configuration de Nginx en tant que serveur web et reverse proxy a \u00e9t\u00e9 r\u00e9alis\u00e9e avec succ\u00e8s. Les diff\u00e9rentes \u00e9tapes ont permis de mettre en place des redirections, de configurer SSL/TLS, et de g\u00e9rer plusieurs sites sur un m\u00eame serveur.</li> </ol>"},{"location":"reverse_proxy/#compte-rendu-dinstallation-et-configuration-de-heartbeat","title":"Compte Rendu d'Installation et Configuration de Heartbeat","text":"<p>Configuration de ha.cf :</p> <p>Sur le serveur srv-nginx2 :</p> <pre><code>    node srv-nginx2\n    ucast ens3 192.168.45.250\n    node srv-nginx\n    ucast ens3 192.168.45.248\n</code></pre> <p>Sur le serveur srv-nginx :</p> <pre><code>    node srv-nginx2\n    ucast ens3 192.168.45.250\n    node srv-nginx\n    ucast ens3 192.168.45.248\n</code></pre> <p>Ces configurations permettent aux serveurs de communiquer entre eux via le r\u00e9seau sp\u00e9cifi\u00e9.</p> <p>Cr\u00e9ation du fichier authkeys :</p> <p>G\u00e9n\u00e9ration d'une cl\u00e9 d'authentification avec la commande :</p> <pre><code>    export AUTH_KEY=\"$(command dd if='/dev/urandom' bs=512 count=1 2&gt;'/dev/null' | command openssl sha1 | command cut --delimiter=' ' --fields=2)\"\n</code></pre> <p>\u00c9criture de la cl\u00e9 g\u00e9n\u00e9r\u00e9e dans /etc/ha.d/authkeys. Configuration haresources :</p> <p>Sur le serveur srv-nginx2 :</p> <p><code>srv-nginx2 IPaddr::192.168.45.200/24/ens3</code> Cette configuration sp\u00e9cifie que srv-nginx2 est le serveur pr\u00e9f\u00e9r\u00e9 pour l'adresse IP virtuelle 192.168.45.200.</p> <p>Sur le serveur srv-nginx :</p> <p><code>srv-nginx</code></p>"},{"location":"routeurs/","title":"Configuration","text":""},{"location":"routeurs/#guide-dinstallation-des-routeurs-cisco-r1_orl-et-r2_orl","title":"Guide d'installation des routeurs cisco R1_ORL et R2_ORL","text":""},{"location":"routeurs/#reinitialisation-des-routeurs","title":"R\u00e9initialisation des routeurs","text":"<p>Les boutons des routeurs ne fonctionnaient plus, nous avons donc r\u00e9initialis\u00e9s les routeurs \u00e0 la ligne de commande.</p> <ol> <li>D\u00e8s que les informations apparaissent \u00e0 votre \u00e9cran, appuyer sur les touches <code>CTRL+PAUSE</code> pour acc\u00e9der au <code>ROM MONITOR MODE</code></li> <li>si <code>prompt&gt;</code> appara\u00eet \u00e0 l'\u00e9cran alors ex\u00e9cuter les commandes suivantes: <code>confreg 0x2142</code> et ensuite <code>reset</code></li> <li>Le routeur va red\u00e9marrer et demandera \u00e0 faire le setup, \u00e9crivez <code>no</code></li> <li>Taper <code>enable</code> et ex\u00e9cuter la commande suivante: <code>Copy startup-config running-config</code></li> <li>Cr\u00e9er un mot de passe pour le mode privilege <code>Enable secret \"mdp\"</code> puis pour l'acc\u00e8s \u00e0 la console <code>Password \"mdp\"</code></li> <li>Pour finir taper <code>confreg 2102</code> et <code>copy startup-config running-config</code></li> </ol>"},{"location":"routeurs/#installer-ssh-ici","title":"Installer SSH ici","text":""},{"location":"routeurs/#adressage-ip-dune-interface-dun-routeur-cisco","title":"Adressage IP d'une interface d'un routeur cisco","text":"<p>Routeur R1_ORL</p> <ol> <li>Taper la commande <code>enable</code> puis <code>conf t</code></li> <li>Ex\u00e9cuter les commandes suivantes: <code>int g0/1</code> ; <code>ip address 183.44.145.1 255.255.255.252</code> ;</li> <li>Activer le nat en ext\u00e9rieur car ce r\u00e9seau n'est pas en local <code>ip nat outside</code> Activer l'interface <code>no sh</code> puis quitter <code>exit</code></li> <li>Ensuite, <code>int g0/0.240</code> et <code>ip address 172.28.96.100 255.255.255.0</code> activer l'interface et quitter</li> <li>Pareil avec une autre interface virtuelle: <code>int g0/0.249</code> ; <code>ip address 172.28.105.253 255.255.255.0</code> puis activer le nat en int\u00e9rieur <code>ip nat inside</code>  activer \u00e9galement l'interface et quitter</li> <li>Activer la passerelle par d\u00e9faut : <code>ip route 0.0.0.0 0.0.0.0 183.44.145.2</code></li> <li>cr\u00e9er une acl : <code>access-list 1 permit 172.28.96.0 0.0.31.255</code></li> <li>Rentrer dans <code>conf t</code> et appliquer l'acl <code>ip nat inside source list &lt;numero acl&gt; interface g0/1 overload</code></li> <li>Sur les interfaces virtuelles g0/0.249 et g0/0.240, il faut configurer le tag dot1Q 249 et 240. Ecriver les commandes suivantes: <code>-int g0/0.249</code> <code>-encapsulation dot1Q 249</code> <code>-exit</code> <code>-int g0/0.240</code> <code>-encapsulation dot1Q 240</code> <code>-exit</code> </li> </ol> <p>Routeur R2_ORL</p> <ol> <li>Taper la commande <code>enable</code> puis <code>conf t</code></li> <li>Ex\u00e9cuter les commandes suivantes: <code>int g0/1</code> ; <code>ip address 221.87.145.2 255.255.255.252</code> ;</li> <li>Activer le nat en ext\u00e9rieur car ce r\u00e9seau n'est pas en local <code>ip nat outside</code> Activer l'interface <code>no sh</code> puis quitter <code>exit</code></li> <li>Ensuite, <code>int g0/0.240</code> et <code>ip address 172.28.96.100 255.255.255.0</code> activer l'interface et quitter</li> <li>Pareil avec une autre interface virtuelle: <code>int g0/0.249</code> ; <code>ip address 172.28.105.253 255.255.255.0</code> puis activer le nat en int\u00e9rieur <code>ip nat inside</code>  activer \u00e9galement l'interface et quitter</li> <li>Activer la passerelle par d\u00e9faut : <code>ip route 0.0.0.0 0.0.0.0 183.44.145.2</code></li> <li>cr\u00e9er une acl : <code>access-list 1 permit 172.28.96.0 0.0.31.255</code></li> <li>Rentrer dans <code>conf t</code> et appliquer l'acl <code>ip nat inside source list &lt;numero acl&gt; interface g0/1 overload</code></li> <li>Sur les interfaces virtuelles g0/0.249 et g0/0.240, il faut configurer le tag dot1Q 249 et 240. Ecriver les commandes suivantes: <code>-int g0/0.249</code> <code>-encapsulation dot1Q 249</code> <code>-exit</code> <code>-int g0/0.240</code> <code>-encapsulation dot1Q 240</code> <code>-exit</code></li> </ol>"},{"location":"routeurs/#routeur-fibre-et-adsl-redirection-de-port","title":"Routeur Fibre et ADSL redirection de port","text":""},{"location":"routeurs/#connexion-au-routeur-via-ssh","title":"Connexion au Routeur via SSH :","text":"<p>J'ai utilis\u00e9 un client SSH (Secure Shell) pour \u00e9tablir une connexion avec mon routeur :</p> <p><code>ssh admin@172.28.105.252</code></p>"},{"location":"routeurs/#configuration-de-la-regle-de-redirection-de-port","title":"Configuration de la R\u00e8gle de Redirection de Port :","text":"<p>J'ai configur\u00e9 une nouvelle r\u00e8gle de redirection de port pour acceder \u00e0 notre site web, on a donc fait une redirection du port 80(HTTP) avec les commandes suivantes :</p> <p><code>conf t</code> <code>ip nat inside source static tcp 192.168.45.253 80 interface GigabitEthernet0/1 80</code></p>"},{"location":"schema/","title":"-Infrastructure","text":""},{"location":"serveur/","title":"-Serveur","text":""},{"location":"serveur/#creation-serveur-orl_dc_01-vm-nutanix","title":"Cr\u00e9ation serveur ORL_DC_01 vm nutanix:","text":"<p>Acc\u00e9der au site nutanix via <code>https://172.16.90.200:9440</code>  Se connecter avec ses id du r\u00e9seau SIO  Cr\u00e9er une vm et la nommer selon la convention du cahier des charges soit ORL_X.   On ajoute 2 cd-rom, un contenant l'ISO de windows, un contenant des pilotes n\u00e9cessaires \u00e0 Nutanix et un disk d'environ 50G.  On ajoute \u00e9galement 2 cartes r\u00e9seaux sur les bons vlans (vlan 240 et 241 dans notre cas).   Cocher la case \"Use this VM as an Agent VM\" sur la page suivant et cliquer sur next.  Lancement de la Vm et installation de windows serveur de fa\u00e7on classique.  Changement du nom NetBios du serveur.  Mise en place d'IP fixe: sur l'ethernet1 \"172.28.97.10 255.255.255.0\" ethernet2 \"172.28.96.10 255.255.255.0\"  Ajout du r\u00f4le ADDS sur le serveur.   On promouvoit le serveur en contr\u00f4leur de domaine.  Notre domaine est \"local.orleans.sportludique.fr\".  On ajoute ensuite les r\u00f4les DNS et DHCP.  CONFIGURATION ETENDUE DHCP  </p>"},{"location":"serveur_dns/","title":"Guide de Configuration du Serveur DNS sur Nutanix","text":""},{"location":"serveur_dns/#etape-1-creation-du-serveur-dns-sur-nutanix","title":"\u00c9tape 1: Cr\u00e9ation du Serveur DNS sur Nutanix","text":""},{"location":"serveur_dns/#11-prerequis","title":"1.1 Pr\u00e9requis","text":"<p>Avant de commencer, assurez-vous d'avoir une instance Nutanix provisionn\u00e9e et pr\u00eate \u00e0 \u00eatre configur\u00e9e. Connectez-vous \u00e0 la console d'administration pour acc\u00e9der \u00e0 la configuration de la machine virtuelle.</p>"},{"location":"serveur_dns/#12-installation-de-bind9","title":"1.2 Installation de BIND9","text":"<p>Sur la machine virtuelle Nutanix, installez BIND9 en utilisant les commandes suivantes :</p> <pre><code>sudo apt-get update\nsudo apt-get install bind9\n</code></pre>"},{"location":"serveur_dns/#13-configuration-de-bind9","title":"1.3 Configuration de BIND9","text":"<p>Apr\u00e8s l'installation, vous pouvez configurer le serveur DNS en modifiant le fichier <code>/etc/bind/named.conf.options</code> en utilisant la commande suivante :</p> <pre><code>sudo nano /etc/bind/named.conf.options\n</code></pre> <p>Dans le fichier de configuration, ajoutez les lignes suivantes :</p> <pre><code>forwarders {t-get install bind9\noptions {\n    directory \"/var/cache/bind\";\n\n    // If there is a firewall between you and nameservers you want\n    // to talk to, you may need to fix the firewall to allow multiple\n    // ports to talk.  See http://www.kb.cert.org/vuls/id/800113\n\n    // If your ISP provided one or more IP addresses for stable\n    // nameservers, you probably want to use them as forwarders.\n    // Uncomment the following block, and insert the addresses replacing\n    // the all-0's placeholder.\n\n    // forwarders {\n    //     121.183.90.205;\n    // };\n\n    dnssec-validation no;\n\n    allow-query {\n        127.0.0.0/8;\n        172.28.0.0/16;\n        192.168.45.0/24;\n        192.168.145.0/24;\n        121.183.90.0/24; \n    };\n\n    listen-on-v6 { none; };\n    listen-on { any; };\n};\n</code></pre>"},{"location":"serveur_dns/#14-redemarrage-de-bind9","title":"1.4 Red\u00e9marrage de BIND9","text":"<p>Apr\u00e8s avoir configur\u00e9 BIND9, vous pouvez red\u00e9marrer le service en utilisant la commande suivante :</p> <pre><code>sudo systemctl restart bind9\n</code></pre>"},{"location":"serveur_dns/#etape-2-creation-des-fichiers-de-zone","title":"\u00c9tape 2: Cr\u00e9ation des fichiers de zone","text":""},{"location":"serveur_dns/#21-creation-du-fichier-de-zone-interne","title":"2.1: Cr\u00e9ation du fichier de zone interne","text":"<p>Nous avons besoin d'un fichier de zone interne, pour le cr\u00e9er:</p> <pre><code>sudo cat db.internal\n</code></pre> <p>Dans ce fichier doit se trouver \u00e7a :</p> <pre><code>\n$TTL 86400\n@   IN  SOA     ns1.orleans.sportludique.fr. admin.orleans.sportludique.fr. (\n                 2019101601 ; Serial\n                 10800      ; Refresh\n                 3600       ; Retry\n                 604800     ; Expire\n                 86400 )    ; Minimum TTL\n\n@           IN  NS      ns1.orleans.sportludique.fr.\nns1         IN  A       192.168.45.252\nwww         IN  A       192.168.45.253\n\n\n\nlocal.orleans.sportludique.fr.   IN      NS      orl-dc-01.local.orleans.sportludique.fr.\norl-dc-01.local.orleans.sportludique.fr.         IN      A       172.28.97.10\n\nblog IN CNAME www.orleans.sportludique.fr.\n\nrp1 IN A 192.168.45.250\nnode IN CNAME rp1.orleans.sportludique.fr.\n\ndouble-reverse-proxy IN A 192.168.45.248\ndbrp   IN CNAME double-reverse-proxy.orleans.sportludique.fr.\n\nchat IN CNAME rp1.orleans.sportludique.fr.\n\n</code></pre> <p>un fichier de zone interne facilite la r\u00e9solution des noms de domaine \u00e0 l'int\u00e9rieur d'un r\u00e9seau priv\u00e9, en associant des noms conviviaux \u00e0 des adresses IP et en organisant la structure des ressources au sein du r\u00e9seau local. Cela contribue \u00e0 une gestion efficace des ressources et \u00e0 une navigation plus conviviale pour les utilisateurs du r\u00e9seau.</p>"},{"location":"serveur_dns/#22-creation-du-fichier-de-zone-externe","title":"2.2 Cr\u00e9ation du fichier de zone externe","text":"<p>M\u00eame principe que le fichier de zone interne, sauf que le fichier doit s'appeler <code>db.external</code></p> <pre><code>User\n\n$TTL 86400\n@   IN  SOA     ns1.orleans.sportludique.fr. admin.orleans.sportludique.fr. (\n                 2019101601 ; Serial\n                 10800      ; Refresh\n                 3600       ; Retry\n                 604800     ; Expire\n                 86400 )    ; Minimum TTL\n\n\n@           IN  NS      ns1.orleans.sportludique.fr.\nns1         IN  A       183.44.45.1\nns1         IN  A       221.87.145.2\nwww         IN  CNAME   ns1.orleans.sportludique.fr.\n\nblog IN CNAME www.orleans.sportludique.fr.\n\nnode IN CNAME ns1.orleans.sportludique.fr.\nchat IN CNAME ns1.orleans.sportludique.fr.\n</code></pre> <p>Le fichier de zone externe permet d'associer des noms de domaine conviviaux \u00e0 des adresses IP accessibles depuis l'ext\u00e9rieur du r\u00e9seau local. Cela permet aux autres utilisateurs d'acc\u00e9der \u00e0 des services tels que WordPress, Node.js, Chat et Apache en utilisant des noms de domaine plut\u00f4t que des adresses IP. Ainsi, les utilisateurs peuvent acc\u00e9der \u00e0 ces services en utilisant des URL plus conviviales.</p>"},{"location":"serveur_dns/#etape-3-ajout-des-zones-dns","title":"\u00c9tape 3: Ajout des zones DNS","text":""},{"location":"serveur_dns/#31-creation-des-zones-dns","title":"3.1 Cr\u00e9ation des zones DNS","text":"<p>Apr\u00e8s avoir configur\u00e9 BIND9 ainsi que les fichiers de zone, vous pouvez ajouter les zones DNS en modifiant le fichier <code>/etc/bind/named.conf.local</code> en utilisant la commande suivante :</p> <pre><code>sudo nano /etc/bind/named.conf.local\n</code></pre> <p>Dans le fichier de configuration, ajoutez les lignes suivantes :</p> <pre><code>view \"externe\" {\n        match-clients{\n                !172.28.0.0/16;\n                !192.168.45.0/24;\n                !127.0.0.0/8;\n                any;\n        };\n        zone \"orleans.sportludique.fr.\" {\n        type master;\n                file \"/etc/bind/db.external\";\n                allow-update { none; };\n        };\n\n};\n\n\nview \"interne\" {\n        match-clients{\n                127.0.0.0/8;\n                172.28.0.0/16;\n                192.168.45.0/24;\n        };\n        zone \"orleans.sportludique.fr.\" {\n        type master;\n                file \"/etc/bind/db.internal\";\n                allow-update { none; };\n        };\n\n};\n\n</code></pre> <p>Le code ci-dessus repr\u00e9sente une configuration de zones DNS pour le serveur BIND9, d\u00e9finissant deux vues distinctes : \"externe\" et \"interne\".</p>"},{"location":"serveur_dns/#vue-externe","title":"Vue Externe","text":"<p>La vue \"externe\" est destin\u00e9e aux clients externes au r\u00e9seau local. Elle sp\u00e9cifie les adresses IP des clients autoris\u00e9s \u00e0 acc\u00e9der \u00e0 cette vue \u00e0 l'aide de la directive <code>match-clients</code>. Dans cet exemple, les adresses IP des r\u00e9seaux <code>172.28.0.0/16</code>, <code>192.168.45.0/24</code>, et <code>127.0.0.0/8</code> sont exclues, ce qui signifie que tous les autres clients sont autoris\u00e9s.</p> <p>La zone \"orleans.sportludique.fr.\" est d\u00e9finie comme une zone ma\u00eetre (master) dans cette vue. Elle utilise le fichier de zone <code>/etc/bind/db.external</code> pour stocker les enregistrements DNS de cette zone. La directive <code>allow-update</code> est d\u00e9finie sur \"none\", ce qui signifie qu'aucune mise \u00e0 jour dynamique n'est autoris\u00e9e pour cette zone.</p>"},{"location":"serveur_dns/#vue-interne","title":"Vue Interne","text":"<p>La vue \"interne\" est destin\u00e9e aux clients internes au r\u00e9seau local. Elle sp\u00e9cifie les adresses IP des clients autoris\u00e9s \u00e0 acc\u00e9der \u00e0 cette vue. Dans cet exemple, les adresses IP des r\u00e9seaux <code>127.0.0.0/8</code>, <code>172.28.0.0/16</code>, et <code>192.168.45.0/24</code> sont autoris\u00e9es.</p> <p>La zone \"orleans.sportludique.fr.\" est \u00e9galement d\u00e9finie comme une zone ma\u00eetre dans cette vue. Elle utilise le fichier de zone <code>/etc/bind/db.internal</code> pour stocker les enregistrements DNS de cette zone. La directive <code>allow-update</code> est d\u00e9finie sur \"none\", ce qui signifie qu'aucune mise \u00e0 jour dynamique n'est autoris\u00e9e pour cette zone.</p> <p>Ces configurations permettent de g\u00e9rer les zones DNS de mani\u00e8re diff\u00e9rente en fonction de la source des requ\u00eates DNS. Les clients externes auront acc\u00e8s \u00e0 la vue \"externe\" avec les enregistrements DNS correspondants, tandis que les clients internes auront acc\u00e8s \u00e0 la vue \"interne\" avec les enregistrements DNS correspondants.</p> <p>Note : Il est important de red\u00e9marrer le service bind9 \u00e0 chaque modification des fichiers de configuration.</p> <pre><code>sudo systemctl restart bind9\n</code></pre>"},{"location":"serveur_docker/","title":"Cr\u00e9ation du serveur Docker","text":""},{"location":"serveur_docker/#etape-1-creation-du-serveur-docker-sur-nutanix","title":"\u00c9tape 1: Cr\u00e9ation du Serveur Docker sur Nutanix","text":""},{"location":"serveur_docker/#11-prerequis","title":"1.1 Pr\u00e9requis","text":"<p>Avant de commencer, il faut cr\u00e9er la machine virtuelle sur Nutanix, avec un OS Debian.</p>"},{"location":"serveur_docker/#12-installation-de-docker","title":"1.2 Installation de Docker","text":"<p>Pour installer Docker, on utilise la documentation officiel. Sur la machine, recopier ces lignes.</p> <pre><code>\nsudo apt-get update\nsudo apt-get install ca-certificates curl gnupg\nsudo install -m 0755 -d /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\nsudo chmod a+r /etc/apt/keyrings/docker.gpg\n\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \\\n  $(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n</code></pre> <p>Pour v\u00e9rifier que l'installation s'est bien pass\u00e9e :</p> <pre><code>sudo docker run hello-world\n</code></pre>"},{"location":"serveur_docker/#etape-2-creation-dun-conteneur-nodejs","title":"\u00c9tape 2: Cr\u00e9ation d'un conteneur Node.js","text":""},{"location":"serveur_docker/#21-prerequis","title":"2.1 Pr\u00e9requis","text":"<p>Avant de commencer, il faut cr\u00e9er un nouveau dossier qui va contenir notre application Node.js.</p> <pre><code>mkdir test-app\ncd test-app\n</code></pre>"},{"location":"serveur_docker/#22-creation-de-lapplication-nodejs","title":"2.2 Cr\u00e9ation de l'application Node.js","text":"<p>Cr\u00e9ation d'un fichier app.js qui doit contenir ce code:</p> <pre><code>// app.js\nconst http = require('http');\n\nconst server = http.createServer((req, res) =&gt; {\n  res.statusCode = 200;\n  res.setHeader('Content-Type', 'text/plain');\n  res.end('Hello, Docker!\\n');\n});\n\nconst port = process.env.PORT || 3000;\n\nserver.listen(port, () =&gt; {\n  console.log(`Server running on http://192.168.45.251:${port}`);\n});\n</code></pre> <p>Ensuite cr\u00e9er un fichier Dockerfile qui se situera dans le m\u00eame r\u00e9pertoire, il doit contenir cela :</p> <pre><code># Use the official Node.js image\nFROM node:14\n\n# Set the working directory\nWORKDIR /testnodejsdocker/\n\n# Install app dependencies\nRUN npm install\n\n# Bundle app source\nCOPY . .\n\n# Expose the port\nEXPOSE 3000\n\n# Command to run the application\nCMD [\"node\", \"app.js\"]\n</code></pre>"},{"location":"serveur_docker/#23-creation-de-limage-docker","title":"2.3 Cr\u00e9ation de l'image Docker","text":"<p>Pour cr\u00e9er l'image Docker, il faut utiliser la commande suivante :</p> <pre><code>sudo docker build -t nodejs .\n</code></pre>"},{"location":"serveur_docker/#24-lancement-du-conteneur","title":"2.4 Lancement du conteneur","text":"<p>Pour lancer le conteneur sur le port 80, il faut utiliser la commande suivante :</p> <pre><code>sudo docker run -d -p 80:3000 nodejs\n</code></pre>"},{"location":"serveur_docker/#25-verification-de-lapplication","title":"2.5 V\u00e9rification de l'application","text":"<p>Pour v\u00e9rifier que l'application fonctionne, dirigez-vous sur internet et copier <code>http://192.168.45.251</code> Comme l'enregistrement DNS CNAME a d\u00e9j\u00e0 \u00e9t\u00e9 fait sur le serveur DNS on peut aussi \u00e9crire <code>http://node.orleans.sportludique.fr</code> pour y acc\u00e9der</p>"},{"location":"serveur_docker/#etape-3-installation-de-portnainer","title":"\u00c9tape 3: Installation de Portnainer","text":""},{"location":"serveur_docker/#31-creation-du-conteneur-portainer","title":"3.1 Cr\u00e9ation du conteneur Portainer","text":"<p>Pour cr\u00e9er le conteneur Portainer, il faut utiliser la commande suivante :</p> <pre><code>docker run -d -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer-ce\n</code></pre>"},{"location":"serveur_docker/#32-verification-de-portainer","title":"3.2 V\u00e9rification de Portainer","text":"<p>Pour v\u00e9rifier que Portainer fonctionne, dirigez-vous sur internet et copier <code>http://192.168.45.251:9000</code></p>"},{"location":"switch/","title":"-Switch","text":""},{"location":"switch/#guide-dinstallation-de-ssh-et-creation-de-vlan-sur-un-switch-cisco","title":"Guide d'Installation de SSH et Cr\u00e9ation de VLAN sur un Switch Cisco","text":""},{"location":"switch/#installation-de-ssh-sur-le-switch","title":"Installation de SSH sur le Switch","text":"<ol> <li>Connexion au Switch : On se connecte au switch Cisco via le c\u00e2ble console en utilisant un client de terminal.</li> <li>On a g\u00e9n\u00e9r\u00e9 une paire de cl\u00e9s SSH RSA pour l'authentification avec la commande <code>switch(config)# crypto key generate rsa</code> puis ensuite vous entrez <code>2048</code>.</li> <li>Configuration SSH :     On a activ\u00e9 le service SSH (version 2) en utilisant les commandes suivantes :     <code>switch(config)# ip ssh version 2</code> <code>switch(config)# line vty 04</code> <code>switch(config-line)# transport input ssh</code> <code>switch(config-line)# transport output ssh</code> <code>switch(config-line)# login local</code> <code>switch(config-line)# exit</code>     Il ne faut pas oublier d'entrer :     <code>copy running-config startup-config</code> </li> </ol>"},{"location":"switch/#creation-de-vlan-sur-le-switch","title":"Cr\u00e9ation de VLAN sur le Switch","text":"<ol> <li>Configuration des VLANs : </li> <li>On acc\u00e9de au mode de configuration VLAN en conf-t.</li> <li>Pour cr\u00e9er un VLAN il faut sp\u00e9cifier son num\u00e9ro, pour cr\u00e9er notre vlan Management on utilise le vlan 240 et on lui donne un nom, de plus on lui attribue l'adresse ip suivante \"172.28.96.1\" en /24 :      <code>switch(config)#int vlan 240</code> <code>switch(config)#ip address 172.28.96.1 255.255.255.0</code> <code>switch(config-if)#no sh</code> <code>switch(config-if)#ex</code> <code>switch(config)#vlan 240</code> <code>switch(config-vlan)#name Management</code></li> <li> <p>On peut rep\u00e9ter ce processus pour cr\u00e9er d'autres VLANs si n\u00e9cessaire nottament pour la cr\u00e9ation de la DMZ.</p> </li> <li> <p>Attribution des Ports aux VLANs :</p> </li> <li>On acc\u00e9de au mode de configuration de l'interface du port qu'on souhaite attribuer \u00e0 un VLAN pour notre part on va lui attribuer le port g0/1.     <code>switch(config)#int g0/1</code> <code>switch(config-if)#switchport mode access</code> <code>switch(config-if)#switchport access vlan 240</code></li> </ol>"},{"location":"switch/#activation-du-routing","title":"Activation du Routing :","text":"<ul> <li>Le routage doit tout d'abord \u00eatre activ\u00e9 sur le switch.  <code>switch(config)#ip routing</code> </li> </ul>"},{"location":"switch/#mise-en-place-du-tftp","title":"Mise en place du TFTP","text":"<ul> <li>Pour pouvoir mettre en place le tftpd on doit d'abord ouvrir un serveur tftp.</li> <li>Pour ce faire on se rend sur MobaXterm, dans l'onglet \"Servers\" qui se trouve dans la barre du haut, le port est automatiquement configur\u00e9 sur le port 69, il suffit juste de l'activer et sur notre switch qui se trouve sur le m\u00eame r\u00e9seau, on entre la commande suivante :  <code>copy running-config tftp:</code></li> </ul>"},{"location":"switch/#configuration-du-relai-dhcp","title":"Configuration du relai DHCP","text":"<ul> <li>Le relai DHCP est fait pour indiquer ou se trouve le serveur DHCP </li> <li>Se placer dans l'interface du vlan 241 (vlan serveur) <code>int vlan 241</code> puis <code>ip helper-adress 172.28.97.10</code> </li> </ul>"}]}